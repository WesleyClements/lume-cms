import{javascript}from"./javascript-BAZ6vl4a.js";var ATTRS_NEST={"{":"}","(":")","[":"]"};function defaultCopyState(state){if("object"!=typeof state)return state;let newState={};for(let prop in state){let val=state[prop];newState[prop]=val instanceof Array?val.slice():val}return newState}class State{constructor(indentUnit){this.indentUnit=indentUnit,this.javaScriptLine=!1,this.javaScriptLineExcludesColon=!1,this.javaScriptArguments=!1,this.javaScriptArgumentsDepth=0,this.isInterpolating=!1,this.interpolationNesting=0,this.jsState=javascript.startState(indentUnit),this.restOfLine="",this.isIncludeFiltered=!1,this.isEach=!1,this.lastTag="",this.isAttrs=!1,this.attrsNest=[],this.inAttributeName=!0,this.attributeIsType=!1,this.attrValue="",this.indentOf=1/0,this.indentToken=""}copy(){var res=new State(this.indentUnit);return res.javaScriptLine=this.javaScriptLine,res.javaScriptLineExcludesColon=this.javaScriptLineExcludesColon,res.javaScriptArguments=this.javaScriptArguments,res.javaScriptArgumentsDepth=this.javaScriptArgumentsDepth,res.isInterpolating=this.isInterpolating,res.interpolationNesting=this.interpolationNesting,res.jsState=(javascript.copyState||defaultCopyState)(this.jsState),res.restOfLine=this.restOfLine,res.isIncludeFiltered=this.isIncludeFiltered,res.isEach=this.isEach,res.lastTag=this.lastTag,res.isAttrs=this.isAttrs,res.attrsNest=this.attrsNest.slice(),res.inAttributeName=this.inAttributeName,res.attributeIsType=this.attributeIsType,res.attrValue=this.attrValue,res.indentOf=this.indentOf,res.indentToken=this.indentToken,res}}function javaScript(stream,state){if(stream.sol()&&(state.javaScriptLine=!1,state.javaScriptLineExcludesColon=!1),state.javaScriptLine){if(state.javaScriptLineExcludesColon&&":"===stream.peek())return state.javaScriptLine=!1,void(state.javaScriptLineExcludesColon=!1);var tok=javascript.token(stream,state.jsState);return stream.eol()&&(state.javaScriptLine=!1),tok||!0}}function javaScriptArguments(stream,state){if(state.javaScriptArguments)return 0===state.javaScriptArgumentsDepth&&"("!==stream.peek()?void(state.javaScriptArguments=!1):("("===stream.peek()?state.javaScriptArgumentsDepth++:")"===stream.peek()&&state.javaScriptArgumentsDepth--,0===state.javaScriptArgumentsDepth?void(state.javaScriptArguments=!1):javascript.token(stream,state.jsState)||!0)}function yieldStatement(stream){if(stream.match(/^yield\b/))return"keyword"}function doctype(stream){if(stream.match(/^(?:doctype) *([^\n]+)?/))return"meta"}function interpolation(stream,state){if(stream.match("#{"))return state.isInterpolating=!0,state.interpolationNesting=0,"punctuation"}function interpolationContinued(stream,state){if(state.isInterpolating){if("}"===stream.peek()){if(state.interpolationNesting--,state.interpolationNesting<0)return stream.next(),state.isInterpolating=!1,"punctuation"}else"{"===stream.peek()&&state.interpolationNesting++;return javascript.token(stream,state.jsState)||!0}}function caseStatement(stream,state){if(stream.match(/^case\b/))return state.javaScriptLine=!0,"keyword"}function when(stream,state){if(stream.match(/^when\b/))return state.javaScriptLine=!0,state.javaScriptLineExcludesColon=!0,"keyword"}function defaultStatement(stream){if(stream.match(/^default\b/))return"keyword"}function extendsStatement(stream,state){if(stream.match(/^extends?\b/))return state.restOfLine="string","keyword"}function append(stream,state){if(stream.match(/^append\b/))return state.restOfLine="variable","keyword"}function prepend(stream,state){if(stream.match(/^prepend\b/))return state.restOfLine="variable","keyword"}function block(stream,state){if(stream.match(/^block\b *(?:(prepend|append)\b)?/))return state.restOfLine="variable","keyword"}function include(stream,state){if(stream.match(/^include\b/))return state.restOfLine="string","keyword"}function includeFiltered(stream,state){if(stream.match(/^include:([a-zA-Z0-9\-]+)/,!1)&&stream.match("include"))return state.isIncludeFiltered=!0,"keyword"}function includeFilteredContinued(stream,state){if(state.isIncludeFiltered){var tok=filter(stream,state);return state.isIncludeFiltered=!1,state.restOfLine="string",tok}}function mixin(stream,state){if(stream.match(/^mixin\b/))return state.javaScriptLine=!0,"keyword"}function call(stream,state){return stream.match(/^\+([-\w]+)/)?(stream.match(/^\( *[-\w]+ *=/,!1)||(state.javaScriptArguments=!0,state.javaScriptArgumentsDepth=0),"variable"):stream.match("+#{",!1)?(stream.next(),state.mixinCallAfter=!0,interpolation(stream,state)):void 0}function callArguments(stream,state){if(state.mixinCallAfter)return state.mixinCallAfter=!1,stream.match(/^\( *[-\w]+ *=/,!1)||(state.javaScriptArguments=!0,state.javaScriptArgumentsDepth=0),!0}function conditional(stream,state){if(stream.match(/^(if|unless|else if|else)\b/))return state.javaScriptLine=!0,"keyword"}function each(stream,state){if(stream.match(/^(- *)?(each|for)\b/))return state.isEach=!0,"keyword"}function eachContinued(stream,state){if(state.isEach){if(stream.match(/^ in\b/))return state.javaScriptLine=!0,state.isEach=!1,"keyword";if(stream.sol()||stream.eol())state.isEach=!1;else if(stream.next()){for(;!stream.match(/^ in\b/,!1)&&stream.next(););return"variable"}}}function whileStatement(stream,state){if(stream.match(/^while\b/))return state.javaScriptLine=!0,"keyword"}function tag(stream,state){var captures;if(captures=stream.match(/^(\w(?:[-:\w]*\w)?)\/?/))return state.lastTag=captures[1].toLowerCase(),"tag"}function filter(stream,state){if(stream.match(/^:([\w\-]+)/))return setStringMode(stream,state),"atom"}function code(stream,state){if(stream.match(/^(!?=|-)/))return state.javaScriptLine=!0,"punctuation"}function id(stream){if(stream.match(/^#([\w-]+)/))return"builtin"}function className(stream){if(stream.match(/^\.([\w-]+)/))return"className"}function attrs(stream,state){if("("==stream.peek())return stream.next(),state.isAttrs=!0,state.attrsNest=[],state.inAttributeName=!0,state.attrValue="",state.attributeIsType=!1,"punctuation"}function attrsContinued(stream,state){if(state.isAttrs){if(ATTRS_NEST[stream.peek()]&&state.attrsNest.push(ATTRS_NEST[stream.peek()]),state.attrsNest[state.attrsNest.length-1]===stream.peek())state.attrsNest.pop();else if(stream.eat(")"))return state.isAttrs=!1,"punctuation";if(state.inAttributeName&&stream.match(/^[^=,\)!]+/))return"="!==stream.peek()&&"!"!==stream.peek()||(state.inAttributeName=!1,state.jsState=javascript.startState(2),"script"===state.lastTag&&"type"===stream.current().trim().toLowerCase()?state.attributeIsType=!0:state.attributeIsType=!1),"attribute";var tok=javascript.token(stream,state.jsState);if(0===state.attrsNest.length&&("string"===tok||"variable"===tok||"keyword"===tok))try{return Function("","var x "+state.attrValue.replace(/,\s*$/,"").replace(/^!/,"")),state.inAttributeName=!0,state.attrValue="",stream.backUp(stream.current().length),attrsContinued(stream,state)}catch(ex){}return state.attrValue+=stream.current(),tok||!0}}function attributesBlock(stream,state){if(stream.match(/^&attributes\b/))return state.javaScriptArguments=!0,state.javaScriptArgumentsDepth=0,"keyword"}function indent(stream){if(stream.sol()&&stream.eatSpace())return"indent"}function comment(stream,state){if(stream.match(/^ *\/\/(-)?([^\n]*)/))return state.indentOf=stream.indentation(),state.indentToken="comment","comment"}function colon(stream){if(stream.match(/^: */))return"colon"}function text(stream,state){return stream.match(/^(?:\| ?| )([^\n]+)/)?"string":stream.match(/^(<[^\n]*)/,!1)?(setStringMode(stream,state),stream.skipToEnd(),state.indentToken):void 0}function dot(stream,state){if(stream.eat("."))return setStringMode(stream,state),"dot"}function fail(stream){return stream.next(),null}function setStringMode(stream,state){state.indentOf=stream.indentation(),state.indentToken="string"}function restOfLine(stream,state){if(stream.sol()&&(state.restOfLine=""),state.restOfLine){stream.skipToEnd();var tok=state.restOfLine;return state.restOfLine="",tok}}function startState(indentUnit){return new State(indentUnit)}function copyState(state){return state.copy()}function nextToken(stream,state){var tok=restOfLine(stream,state)||interpolationContinued(stream,state)||includeFilteredContinued(stream,state)||eachContinued(stream,state)||attrsContinued(stream,state)||javaScript(stream,state)||javaScriptArguments(stream,state)||callArguments(stream,state)||yieldStatement(stream)||doctype(stream)||interpolation(stream,state)||caseStatement(stream,state)||when(stream,state)||defaultStatement(stream)||extendsStatement(stream,state)||append(stream,state)||prepend(stream,state)||block(stream,state)||include(stream,state)||includeFiltered(stream,state)||mixin(stream,state)||call(stream,state)||conditional(stream,state)||each(stream,state)||whileStatement(stream,state)||tag(stream,state)||filter(stream,state)||code(stream,state)||id(stream)||className(stream)||attrs(stream,state)||attributesBlock(stream,state)||indent(stream)||text(stream,state)||comment(stream,state)||colon(stream)||dot(stream,state)||fail(stream);return!0===tok?null:tok}const pug={startState:startState,copyState:copyState,token:nextToken};export{pug};